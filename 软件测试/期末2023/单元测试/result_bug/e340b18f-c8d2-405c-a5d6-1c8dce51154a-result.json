{"name": "测试创建订单:填写的菜品id不是该商家", "status": "broken", "statusDetails": {"message": "AttributeError: 'NoneType' object has no attribute 'id'", "trace": "self = <seproject_app.main.Test_1 testMethod=test66>\n\n    @allure.epic('单元')\n    @allure.feature('顾客点餐模块')\n    @allure.story('顾客创建订单')\n    @allure.title('测试创建订单:填写的菜品id不是该商家')\n    @allure.description('测试登录:测试用例描述信息')\n    def test66(self):\n        '''\n        创建订单\n        '''\n        print()\n        n = 'test6'\n        # 接口地址\n        func = 'createOrder'\n        # 构造数据\n        t = _data[n]\n        headers = {\"cookie\": \"openid=oxxHL5GS26iMW6iSMzfoLjXk1luw\"}\n        i = t[6]\n        params = i['params']\n        re = i['return']\n>       r = client.post(func, json=params, headers=headers).json()\n\nseproject_app\\main.py:1011: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\nd:\\anaconda\\lib\\site-packages\\starlette\\testclient.py:602: in post\n    extensions=extensions,\nd:\\anaconda\\lib\\site-packages\\httpx\\_client.py:1145: in post\n    extensions=extensions,\nd:\\anaconda\\lib\\site-packages\\starlette\\testclient.py:478: in request\n    extensions=extensions,\nd:\\anaconda\\lib\\site-packages\\httpx\\_client.py:814: in request\n    return self.send(request, auth=auth, follow_redirects=follow_redirects)\nd:\\anaconda\\lib\\site-packages\\httpx\\_client.py:905: in send\n    history=[],\nd:\\anaconda\\lib\\site-packages\\httpx\\_client.py:932: in _send_handling_auth\n    history=history,\nd:\\anaconda\\lib\\site-packages\\httpx\\_client.py:966: in _send_handling_redirects\n    response = self._send_single_request(request)\nd:\\anaconda\\lib\\site-packages\\httpx\\_client.py:1002: in _send_single_request\n    response = transport.handle_request(request)\nd:\\anaconda\\lib\\site-packages\\starlette\\testclient.py:342: in handle_request\n    raise exc\nd:\\anaconda\\lib\\site-packages\\starlette\\testclient.py:339: in handle_request\n    portal.call(self.app, scope, receive, send)\nd:\\anaconda\\lib\\site-packages\\anyio\\from_thread.py:283: in call\n    return cast(T_Retval, self.start_task_soon(func, *args).result())\nd:\\anaconda\\lib\\concurrent\\futures\\_base.py:435: in result\n    return self.__get_result()\nd:\\anaconda\\lib\\concurrent\\futures\\_base.py:384: in __get_result\n    raise self._exception\nd:\\anaconda\\lib\\site-packages\\anyio\\from_thread.py:219: in _call_func\n    retval = await retval\nd:\\anaconda\\lib\\site-packages\\fastapi\\applications.py:276: in __call__\n    await super().__call__(scope, receive, send)\nd:\\anaconda\\lib\\site-packages\\starlette\\applications.py:122: in __call__\n    await self.middleware_stack(scope, receive, send)\nd:\\anaconda\\lib\\site-packages\\starlette\\middleware\\errors.py:184: in __call__\n    raise exc\nd:\\anaconda\\lib\\site-packages\\starlette\\middleware\\errors.py:162: in __call__\n    await self.app(scope, receive, _send)\nd:\\anaconda\\lib\\site-packages\\starlette\\middleware\\exceptions.py:79: in __call__\n    raise exc\nd:\\anaconda\\lib\\site-packages\\starlette\\middleware\\exceptions.py:68: in __call__\n    await self.app(scope, receive, sender)\nd:\\anaconda\\lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py:21: in __call__\n    raise e\nd:\\anaconda\\lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py:18: in __call__\n    await self.app(scope, receive, send)\nd:\\anaconda\\lib\\site-packages\\starlette\\routing.py:718: in __call__\n    await route.handle(scope, receive, send)\nd:\\anaconda\\lib\\site-packages\\starlette\\routing.py:276: in handle\n    await self.app(scope, receive, send)\nd:\\anaconda\\lib\\site-packages\\starlette\\routing.py:66: in app\n    response = await func(request)\nd:\\anaconda\\lib\\site-packages\\fastapi\\routing.py:238: in app\n    dependant=dependant, values=values, is_coroutine=is_coroutine\nd:\\anaconda\\lib\\site-packages\\fastapi\\routing.py:165: in run_endpoint_function\n    return await run_in_threadpool(dependant.call, **values)\nd:\\anaconda\\lib\\site-packages\\starlette\\concurrency.py:41: in run_in_threadpool\n    return await anyio.to_thread.run_sync(func, *args)\nd:\\anaconda\\lib\\site-packages\\anyio\\to_thread.py:32: in run_sync\n    func, *args, cancellable=cancellable, limiter=limiter\nd:\\anaconda\\lib\\site-packages\\anyio\\_backends\\_asyncio.py:937: in run_sync_in_worker_thread\n    return await future\nd:\\anaconda\\lib\\site-packages\\anyio\\_backends\\_asyncio.py:867: in run\n    result = context.run(func, *args)\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\n\norder = OrderCreate(store_id=1, totalPrice=12.0, countArray=[DishOrder(id=1, num=1)])\ndb = <sqlalchemy.orm.session.Session object at 0x0000015299F3A108>, openid = 'oxxHL5GS26iMW6iSMzfoLjXk1luw'\n\n    @app.post(\n        \"/createOrder\",\n        summary=\"顾客创建订单\",\n        description=\"生成订单\",\n        tags=[\"GuestOrderController\"],\n    )\n    # 顾客创建订单\n    def CreateOrder(\n        order: schemas.OrderCreate,\n        db: Session = Depends(get_db),\n        openid: Optional[str] = Cookie(None),\n    ):\n        if not openid:\n            raise HTTPException(status_code=401, detail=\"please login first\")\n    \n        user = crud.get_user_by_openid(db, openid)\n    \n        # 错误检查\n        price = 0.0\n        store = crud.get_shop_by_id(db, order.store_id)\n        if store is None:\n            raise HTTPException(status_code=404, detail=\"Shop not found\")\n        for i in order.countArray:\n            dish = crud.get_dish_by_id(db, i.id)\n            if dish is None:\n                raise HTTPException(status_code=404, detail=\"Dish not found\")\n            if dish.store_id != store.id:\n                raise HTTPException(\n                    status_code=400, detail=\"Not a dish in this shop\")\n            price += dish.price * i.num\n    \n        if price == 0:\n            raise HTTPException(\n                status_code=400, detail=\"Order is empty\")\n        order.totalPrice = round(price, 2)\n        # 订单表内加订单\n>       order_id = crud.create_order(db, user.id, order)\nE       AttributeError: 'NoneType' object has no attribute 'id'\n\nseproject_app\\main.py:206: AttributeError"}, "description": "测试登录:测试用例描述信息", "attachments": [{"name": "log", "source": "1856fab6-5d59-49b7-892a-23c3027d1765-attachment.txt", "type": "text/plain"}, {"name": "stdout", "source": "3e6a3df5-dd88-459b-bf65-39fd4d548fe3-attachment.txt", "type": "text/plain"}], "start": 1684130128208, "stop": 1684130128220, "uuid": "d9eba61b-54aa-47f3-8677-7dbfa9b8d8b9", "historyId": "251624a5fa408c64a082db6132792e66", "testCaseId": "251624a5fa408c64a082db6132792e66", "fullName": "seproject_app.main.Test_1#test66", "labels": [{"name": "epic", "value": "单元"}, {"name": "feature", "value": "顾客点餐模块"}, {"name": "story", "value": "顾客创建订单"}, {"name": "parentSuite", "value": "seproject_app"}, {"name": "suite", "value": "main"}, {"name": "subSuite", "value": "Test_1"}, {"name": "host", "value": "whz"}, {"name": "thread", "value": "13772-MainThread"}, {"name": "framework", "value": "pytest"}, {"name": "language", "value": "cpython3"}, {"name": "package", "value": "seproject_app.main"}]}